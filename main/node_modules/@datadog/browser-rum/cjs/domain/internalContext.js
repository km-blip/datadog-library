"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var browser_core_1 = require("@datadog/browser-core");
/**
 * Internal context keep returning v1 format
 * to not break compatibility with logs data format
 */
function startInternalContext(applicationId, session, parentContexts, configuration) {
    return {
        get: function (startTime) {
            if (configuration.isEnabled('v2_format')) {
                var viewContext = parentContexts.findViewV2(startTime);
                if (session.isTracked() && viewContext && viewContext.session.id) {
                    var actionContext = parentContexts.findActionV2(startTime);
                    return browser_core_1.withSnakeCaseKeys(browser_core_1.combine({ applicationId: applicationId }, { sessionId: viewContext.session.id, view: viewContext.view }, actionContext ? { userAction: { id: actionContext.action.id } } : undefined));
                }
            }
            else {
                var viewContext = parentContexts.findView(startTime);
                if (session.isTracked() && viewContext && viewContext.sessionId) {
                    return browser_core_1.withSnakeCaseKeys(browser_core_1.combine({ applicationId: applicationId }, viewContext, parentContexts.findAction(startTime)));
                }
            }
        },
    };
}
exports.startInternalContext = startInternalContext;
//# sourceMappingURL=internalContext.js.map